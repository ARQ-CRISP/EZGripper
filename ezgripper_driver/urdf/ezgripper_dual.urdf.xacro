<?xml version="1.0"?>
<robot name="ezgripper" xmlns:xacro="http://www.ros.org/wiki/xacro">

<!--macro name="ezgripper" params="*origin"-->



<macro name="ezgripper" params="parent_link *origin">
 

    <!-- links -->

    <link name="palm_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://ezgripper_driver/meshes/visual/SAKE_Palm_Dual.stl"/>
        </geometry>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://ezgripper_driver/meshes/collision/SAKE_Palm_Dual.stl"/>
        </geometry>
      </collision>
    <inertial>
      <mass value=".3"/>
      <inertia ixx="0.03" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="0.0"/>
    </inertial>
    </link>

    <joint name="ezgripper_connect" type="fixed">
        <xacro:insert_block name="origin"/>
        <parent link="${parent_link}"/>
        <child link="palm_link"/>
      <axis xyz="0 0 0"/>
      <limit lower="-1.57075" upper="0.25" effort="0" velocity="3.67"/>
    </joint>


</macro>

<macro name="finger" params="postfix reflect">
    <link name="finger_${postfix}">j
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://ezgripper_driver/meshes/visual/SAKE_Finger.stl"/>
        </geometry>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://ezgripper_driver/meshes/collision/SAKE_Finger.stl"/>
        </geometry>
      </collision>
    <inertial>
      <mass value=".025"/>
      <inertia ixx="0.062" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="0.0"/>
    </inertial>
     </link>
</macro>
<finger postfix="1" reflect="1" />
<finger postfix="2" reflect="1" />
<finger postfix="3" reflect="1" />
<finger postfix="4" reflect="1" />


    <!-- joints -->



<macro name="knuckle" params="postfix reflectY reflectZ mimic_test">
    <joint name="knuckle_${postfix}" type="revolute">
      <parent link="palm_link"/>
      <child link="finger_${postfix}"/>
      <origin xyz="0.088 ${reflectY*0.025} ${reflectZ*0.025}" rpy="${(0.5-0.5*reflectZ)*3.14159} 0 0"/>
      <axis xyz="0 1 0"/>
      <limit lower="-1.57075" upper="0.25" effort="0" velocity="3.67"/>
      <xacro:if value="${mimic_test}">
           <mimic joint="knuckle_1"/>
      </xacro:if>
    </joint>
</macro>
<knuckle postfix="1" reflectY="1" reflectZ="1" mimic_test="false"/>
<knuckle postfix="2" reflectY="-1" reflectZ="1" mimic_test="true"/>
<knuckle postfix="3" reflectY="1" reflectZ="-1" mimic_test="true"/>
<knuckle postfix="4" reflectY="-1" reflectZ="-1" mimic_test="true"/>
 
<macro name="gazebostuff" params="postfix2">
  <gazebo reference="knuckle_${postfix2}">
    <provideFeedback>1</provideFeedback>
    <implicitSpringDamper>1</implicitSpringDamper>
  </gazebo>
</macro>
<gazebostuff postfix2="1"/>
<gazebostuff postfix2="2"/>
<gazebostuff postfix2="3"/>
<gazebostuff postfix2="4"/>



</robot>
